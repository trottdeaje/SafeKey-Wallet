(this.webpackJsonp=this.webpackJsonp||[]).push([[17],{314:function(e,n,t){"use strict";var a=t(20),r=t(1),o=t.n(r),i=a.canUseDOM?window.location.href:"",c=function(){function e(){var e=this;this._eventCallbacks={},this.addEventListener=function(n,t){e._eventCallbacks[n]?e._eventCallbacks[n].push(t):e._eventCallbacks[n]=[t]},this.removeEventListener=function(n,t){var a=e._eventCallbacks[n].filter((function(e){return e.toString()!==t.toString()}));e._eventCallbacks[n]=a}}var n=e.prototype;return n._dispatchEvent=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];var r=this._eventCallbacks[e];null!=r&&Array.isArray(r)&&r.map((function(e){e.apply(void 0,t)}))},n.canOpenURL=function(){return Promise.resolve(!0)},n.getInitialURL=function(){return Promise.resolve(i)},n.openURL=function(e){try{return s(e),this._dispatchEvent("onOpen",e),Promise.resolve()}catch(n){return Promise.reject(n)}},n._validateURL=function(e){o()("string"===typeof e,"Invalid URL: should be a string. Was: "+e),o()(e,"Invalid URL: cannot be empty")},e}(),s=function(e){if(a.canUseDOM){var n=new URL(e,window.location).toString();window.open(n,"_blank","noopener")}};n.a=new c},435:function(e,n,t){"use strict";t.r(n);var a=t(8),r=t.n(a),o=t(4),i=t.n(o),c=t(0),s=t.n(c),l=t(53),u=t(3),f=t(85),d=t(27),m=t(314),p=t(71),b=t(23),g=t(42),y=t(147),v=t(160),h=t(38),w=Object(g.a)((function(){return t.e(11).then(t.t.bind(null,423,7))})),E=d.a.get("window"),x=d.a.get("screen");n.default=function(e){var n=e.navigation,t=Object(c.useState)(!1),a=r()(t,2),o=a[0],g=a[1],S=Object(c.useState)("environment"),k=r()(S,2),C=k[0],L=k[1],O=Object(c.useState)(!1),R=r()(O,2),A=R[0],_=R[1],I=Object(c.useState)({window:E,screen:x}),U=r()(I,2),B=U[0],K=U[1],j=Object(v.b)(),M=function(e){var n=e.window,t=e.screen;K({window:n,screen:t})};Object(c.useEffect)((function(){return d.a.addEventListener("change",M),function(){d.a.removeEventListener("change",M)}}));return s.a.createElement(u.a,{style:[h.a.container,{backgroundColor:"#000",marginBottom:0}]},s.a.createElement(u.a,{style:[h.a.center,{backgroundColor:"#000",fontSize:16,lineHeight:50,textAlign:"center",position:"relative",textAlignVertical:"center",margin:0,zIndex:10,fontSize:16,flex:1,minHeight:80}]},s.a.createElement(l.a,{style:{color:"#f1f1f1",marginBottom:5,marginTop:15}},"Scan your SafeKey Document QR code"),s.a.createElement(l.a,{style:{color:"#f1f1f1"}},"Keep camera steady"),s.a.createElement(l.a,{style:{color:A?"#ffbb33":"#28a745",marginTop:10,fontFamily:"OpenSans_600SemiBold"}},A?"INVALID QR":"SCANNING")),s.a.createElement(w,{facingMode:C,onLoad:function(){console.log("QR Reader Loaded")},delay:300,onError:function(e){console.log(e.name),"NotAllowedError"===e.name&&n.dispatch(b.CommonActions.reset({index:0,routes:[{name:"NoCamera"}]}))},onScan:function(e){o||function(e){var t,a,r,o,c,d,v,w,E,x,S,k,C,L,O,R;i.a.async((function(A){for(;;)switch(A.prev=A.next){case 0:if(t=[":BM.KEY:",":BM.VAX:"],a=[":BM.KEY:"],null===e){A.next=40;break}if(!t.some((function(n){return e.includes(n)}))){A.next=37;break}if(!a.some((function(n){return e.includes(n)}))){A.next=25;break}if(r=e.indexOf(":",130),o=e.indexOf("/"),c=e.substring(r,o),d=c.slice(1),isNaN(d)){A.next=24;break}if(v=parseInt(d.substr(0,4),10),w=parseInt(d.substr(6),10),E=parseInt(d.substr(4,2),10),x=new Date(v,E-1,w),S=new Date,!(x.getTime()<S.getTime())){A.next=18;break}return j.show(s.a.createElement(u.a,null,s.a.createElement(f.a,{onPress:function(){m.a.openURL("https://www.gov.bm/safekey"),j.hide(1)}},s.a.createElement(l.a,{style:[h.a.bold,{color:"#fff"}]},"This SafeKey has expired"),s.a.createElement(l.a,{style:[h.a.text,{color:"#fff",textAlign:"center"}]},"Click here to renew it"))),{offsetBottom:50,id:1,position:"bottom",duration:0,type:"normal",normalColor:"#ff4d4d"}),A.abrupt("return",n.goBack());case 18:return k={weekday:"long",year:"numeric",month:"long",day:"numeric"},C=x.toLocaleString("en-US",k),A.next=22,i.a.awrap(p.a.setItem("passExpiry",C));case 22:A.next=25;break;case 24:console.log("parsed date is not a number");case 25:return L=e.indexOf(":"),L+=1,O=e.indexOf(":",L+1),R=e.substring(L,O),A.next=31,i.a.awrap(p.a.setItem(R,e));case 31:g(!0),y.a("DocumentScanned",{type:"BM.KEY"===R?"SafeKey":"Vaccination Certificate",purpose:"User has scanned their SafeKey QR code."}),n.dispatch(b.CommonActions.reset({index:0,routes:[{name:"QR List"}]})),j.show("BM.KEY"===R?s.a.createElement(u.a,null,s.a.createElement(l.a,{style:[h.a.bold,{color:"#fff"}]},"SafeKey Added")):s.a.createElement(u.a,null,s.a.createElement(l.a,{style:[h.a.bold,{color:"#fff"}]},"Vaccination Certificate Added")),{id:3,type:"success",duration:3500}),A.next=38;break;case 37:_(!0);case 38:A.next=42;break;case 40:g(!1),_(!1);case 42:case"end":return A.stop()}}),null,null,null,Promise)}(e)},style:{width:B.window.width<565?"100%":510,alignSelf:"center"}}),s.a.createElement(u.a,{style:{width:"100%",flex:1,justifyContent:"center"}},s.a.createElement(f.a,{onPress:function(){L("environment"===C?"user":"environment")},style:{paddingHorizontal:10,alignSelf:"center",backgroundColor:"#1971ef",paddingVertical:10,borderRadius:5,marginBottom:25,marginTop:25}},s.a.createElement(l.a,{style:{color:"white",textAlign:"center",letterSpacing:1,fontFamily:"OpenSans_400Regular"}},"Switch Camera"))))}}}]);
//# sourceMappingURL=17.a5c929ca.chunk.js.map