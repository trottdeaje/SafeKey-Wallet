(this.webpackJsonp=this.webpackJsonp||[]).push([[17],{434:function(e,t,n){"use strict";n.r(t);var a=n(7),r=n.n(a),o=n(4),i=n.n(o),c=n(0),s=n.n(c),l=n(52),f=n(2),u=n(83),d=n(26),m=n(319),g=n(70),b=n(22),p=n(39),w=n(332),y=n.n(w),x=n(157),E=n(37),h=Object(p.a)((function(){return n.e(10).then(n.t.bind(null,422,7))})),S=d.a.get("window"),k=d.a.get("screen");t.default=function(e){var t=e.navigation,n=Object(c.useState)(!1),a=r()(n,2),o=a[0],p=a[1],w=Object(c.useState)("environment"),v=r()(w,2),O=v[0],A=v[1],C=Object(c.useState)(!1),B=r()(C,2),I=B[0],j=B[1],L=Object(c.useState)({window:S,screen:k}),N=r()(L,2),R=N[0],K=N[1],T=Object(x.b)(),M=function(e){var t=e.window,n=e.screen;K({window:t,screen:n})};Object(c.useEffect)((function(){return d.a.addEventListener("change",M),function(){d.a.removeEventListener("change",M)}}));return s.a.createElement(f.a,{style:[E.a.container,{backgroundColor:"#000",marginBottom:0}]},s.a.createElement(f.a,{style:[E.a.center,{backgroundColor:"#000",fontSize:16,lineHeight:50,textAlign:"center",position:"relative",textAlignVertical:"center",margin:0,zIndex:10,fontSize:16,flex:1,minHeight:80}]},s.a.createElement(l.a,{style:{color:"#f1f1f1",marginBottom:5,marginTop:15}},"Scan your SafeKey Document QR code"),s.a.createElement(l.a,{style:{color:"#f1f1f1"}},"Keep camera steady"),s.a.createElement(l.a,{style:{color:I?"#ffbb33":"#28a745",marginTop:10,fontFamily:"OpenSans_600SemiBold"}},I?"INVALID QR":"SCANNING")),s.a.createElement(h,{facingMode:O,onLoad:function(){console.log("QR Reader Loaded"),y.a.load((function(){}))},delay:300,onError:function(e){console.log(e.name),"NotAllowedError"===e.name&&t.dispatch(b.CommonActions.reset({index:0,routes:[{name:"NoCamera"}]}))},onScan:function(e){o||function(e){var n,a,r,o,c,d,w,y,x,h,S,k,v,O,A,C;i.a.async((function(B){for(;;)switch(B.prev=B.next){case 0:if(n=[":BM.KEY:",":BM.VAX:"],a=[":BM.KEY:"],null===e){B.next=39;break}if(!n.some((function(t){return e.includes(t)}))){B.next=36;break}if(!a.some((function(t){return e.includes(t)}))){B.next=25;break}if(r=e.indexOf(":",130),o=e.indexOf("/"),c=e.substring(r,o),d=c.slice(1),isNaN(d)){B.next=24;break}if(w=parseInt(d.substr(0,4),10),y=parseInt(d.substr(6),10),x=parseInt(d.substr(4,2),10),h=new Date(w,x-1,y),S=new Date,!(h.getTime()<S.getTime())){B.next=18;break}return T.show(s.a.createElement(f.a,null,s.a.createElement(u.a,{onPress:function(){m.a.openURL("https://www.gov.bm/safekey"),T.hide(1)}},s.a.createElement(l.a,{style:[E.a.bold,{color:"#fff"}]},"This SafeKey has expired"),s.a.createElement(l.a,{style:[E.a.text,{color:"#fff",textAlign:"center"}]},"Click here to renew it"))),{offsetBottom:50,id:1,position:"bottom",duration:0,type:"normal",normalColor:"#ff4d4d"}),B.abrupt("return",t.goBack());case 18:return k={weekday:"long",year:"numeric",month:"long",day:"numeric"},v=h.toLocaleString("en-US",k),B.next=22,i.a.awrap(g.a.setItem("passExpiry",v));case 22:B.next=25;break;case 24:console.log("parsed date is not a number");case 25:return O=e.indexOf(":"),O+=1,A=e.indexOf(":",O+1),C=e.substring(O,A),B.next=31,i.a.awrap(g.a.setItem(C,e));case 31:p(!0),t.dispatch(b.CommonActions.reset({index:0,routes:[{name:"QR List"}]})),T.show("BM.KEY"===C?s.a.createElement(f.a,null,s.a.createElement(l.a,{style:[E.a.bold,{color:"#fff"}]},"SafeKey Added")):s.a.createElement(f.a,null,s.a.createElement(l.a,{style:[E.a.bold,{color:"#fff"}]},"Vaccination Certificate Added")),{id:3,type:"success",duration:3500}),B.next=37;break;case 36:j(!0);case 37:B.next=41;break;case 39:p(!1),j(!1);case 41:case"end":return B.stop()}}),null,null,null,Promise)}(e)},style:{width:R.window.width<565?"100%":510,alignSelf:"center"}}),s.a.createElement(f.a,{style:{width:"100%",flex:1,justifyContent:"center"}},s.a.createElement(u.a,{onPress:function(){A("environment"===O?"user":"environment")},style:{paddingHorizontal:10,alignSelf:"center",backgroundColor:"#1971ef",paddingVertical:10,borderRadius:5,marginBottom:25,marginTop:25}},s.a.createElement(l.a,{style:{color:"white",textAlign:"center",letterSpacing:1,fontFamily:"OpenSans_400Regular"}},"Switch Camera"))))}}}]);
//# sourceMappingURL=17.d3bdfb86.chunk.js.map